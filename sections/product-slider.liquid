{% liquid
    assign products = section.settings.products
%}

<section
    class="
        relative
        {{ section.settings.margin_top }}
        {{ section.settings.margin_bottom }}
    "
>
    <!-- Sticky viewport container -->
    <div class="sticky z-10 top-0 bg-white flex justify-between tablet:-mx-4 desktop:px-16 desktop:pb-16 tablet:px-8 tablet:pb-8">
        <!-- Title row -->
        <h2 class="text-heading-md">
            {{ section.settings.heading }}
        </h2>
        <!-- CTA row -->
        {% if section.settings.cta != blank and section.settings.cta_link != blank %}
            <a
                href="{{ section.settings.cta_link }}"
                class="inline-flex items-center text-heading-md no-underline"
            >
                {{ section.settings.cta }}
            </a>
        {% endif %}
    </div>

    <!-- Slider -->
    <div class="-mx-4 desktop:mx-0 pl-4 desktop:px-0 relative">
        <div
            id="product-slider"
            data-slider
            aria-roledescription="carousel"
            aria-label="{{ section.settings.heading | escape }}"
            class="
                tablet:flex tablet:flex-row tablet:overflow-x-auto tablet:snap-x tablet:snap-mandatory
                gap-1 pb-24 scroll-pl-4 scrollbar-none
                desktop:grid desktop:grid-cols-4 desktop:gap-1 desktop:overflow-visible desktop:scroll-pl-0
            "
        >
            {% for product in products %}
                <div class="tablet:max-w-[65%] shrink-0 tablet:snap-start">
                    {% render 'product-card',
                        product: product,
                        show_badge: section.settings.show_badge,
                        show_sizes: section.settings.show_sizes,
                        show_colours_text: product.metafields.custom.colours_text
                    %}
                </div>
            {% endfor %}
        </div>
    </div>
</section>

{% schema %}
    {
        "name": "t:sections.product_slider.name",
        "settings": [
            {
                "type": "text",
                "id": "heading",
                "label": "t:sections.product_slider.heading.name",
                "default": "t:sections.product_slider.heading.default"
            },
            {
                "type": "text",
                "id": "cta",
                "label": "t:sections.product_slider.heading.cta",
                "default": "t:sections.product_slider.heading.cta_default"
            },
            {
                "type": "url",
                "id": "cta_link",
                "label": "t:sections.product_slider.heading.cta_link",
                "default": "/collections/all"
            },
            {
                "type": "product_list",
                "id": "products",
                "label": "t:sections.product_slider.heading.product_list",
                "limit": 10
            },
            {
                "type": "select",
                "id": "margin_top",
                "label": "Margin top",
                "default": "mt-0",
                "options": [
                    { "value": "mt-0", "label": "None" },
                    { "value": "mt-8", "label": "Small" },
                    { "value": "mt-16", "label": "Medium" },
                    { "value": "mt-24", "label": "Large" }
                ]
            },
            {
                "type": "select",
                "id": "margin_bottom",
                "label": "Margin bottom",
                "default": "mb-0",
                "options": [
                    { "value": "mb-0", "label": "None" },
                    { "value": "mb-8", "label": "Small" },
                    { "value": "mb-16", "label": "Medium" },
                    { "value": "mb-24", "label": "Large" }
                ]
            }
        ],
        "presets": [
            {
                "name": "t:sections.product_slider.name"
            }
        ]
    }
{% endschema %}
